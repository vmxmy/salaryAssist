# è´¢æ”¿å·¥èµ„æ•°æ®å¤„ç†å·¥å…· - ä½¿ç”¨è¯´æ˜Ž ðŸ§°

### 1. ç®€ä»‹ ðŸŽ¯

æœ¬å·¥å…·æ—¨åœ¨è‡ªåŠ¨åŒ–å¤„ç†è´¢æ”¿éƒ¨é—¨çš„å·¥èµ„æ•°æ®ï¼Œèƒ½å¤Ÿåˆå¹¶æºå·¥èµ„è¡¨ä¸Žæ‰£æ¬¾æ˜Žç»†ï¼Œæ ¹æ®çµæ´»çš„æ˜ å°„è§„åˆ™è½¬æ¢å­—æ®µï¼Œæ‰§è¡Œå¤æ‚çš„è®¡ç®—ï¼ˆå¦‚æ‰£å‘åˆè®¡ã€è¡¥å‘å·¥èµ„ã€å®žå‘å·¥èµ„ï¼‰ï¼Œå¹¶æœ€ç»ˆç”Ÿæˆç¬¦åˆæŒ‡å®šæ ¼å¼è¦æ±‚çš„å·¥èµ„å‘æ”¾è¡¨ã€‚

**æ ¸å¿ƒåŠŸèƒ½**: âœ¨

*   **æ•°æ®åˆå¹¶**: è‡ªåŠ¨åˆå¹¶å¤šä¸ªæºå·¥èµ„è¡¨ä¸Žç»Ÿä¸€çš„æ‰£æ¬¾æ˜Žç»†è¡¨ã€‚
*   **å­—æ®µæ˜ å°„**: æ ¹æ®é…ç½®è§„åˆ™ï¼Œå°†æºæ–‡ä»¶ä¸­çš„å­—æ®µåè½¬æ¢ä¸ºæ ‡å‡†è¾“å‡ºå­—æ®µåã€‚
*   **å¤æ‚è®¡ç®—**: æ”¯æŒåŸºäºŽå¤šä¸ªæºå­—æ®µè¿›è¡ŒåŠ æ€»æˆ–å…¶ä»–è‡ªå®šä¹‰è®¡ç®—ï¼Œç”Ÿæˆæ–°çš„ç›®æ ‡å­—æ®µã€‚
*   **æ ¼å¼åŒ–è¾“å‡º**: æŒ‰ç…§é¢„å®šä¹‰çš„ Excel æ¨¡æ¿ç²¾ç¡®æŽ§åˆ¶è¾“å‡ºæ–‡ä»¶çš„åˆ—é¡ºåºå’ŒåŒ…å«çš„å­—æ®µã€‚
*   **ç”¨æˆ·ç•Œé¢**: æä¾›ç®€å•çš„ Web ç•Œé¢ (Streamlit) è¿›è¡Œæ–‡ä»¶ä¸Šä¼ å’Œä»»åŠ¡é…ç½®ã€‚

### 2. å‡†å¤‡å·¥ä½œ âš™ï¸

*   **è¿è¡ŒçŽ¯å¢ƒ**: éœ€è¦å®‰è£… Python (æŽ¨è 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬) ðŸã€‚
*   **ä¾èµ–åº“**: å·¥å…·ä¾èµ– Pandas, Streamlit, Openpyxl ç­‰åº“ã€‚å¦‚æžœæ‚¨ä½¿ç”¨çš„æ˜¯åŒ…å«çŽ¯å¢ƒçš„éƒ¨ç½²åŒ…ï¼Œé€šå¸¸æ— éœ€æ‰‹åŠ¨å®‰è£…ã€‚
*   **å¯åŠ¨å·¥å…·**: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œé€šè¿‡å‘½ä»¤è¡Œè¿è¡Œ `streamlit run app.py` æ¥å¯åŠ¨ Web ç”¨æˆ·ç•Œé¢ ðŸš€ã€‚

### 3. æ–‡ä»¶ç»“æž„ ðŸ“

é¡¹ç›®åŒ…å«ä»¥ä¸‹å…³é”®ç›®å½•å’Œæ–‡ä»¶ï¼š

*   `app.py`: Streamlit åº”ç”¨çš„ä¸»ç¨‹åºæ–‡ä»¶ã€‚
*   `fiscal_report_full_script.py`: åŒ…å«æ ¸å¿ƒæ•°æ®å¤„ç†é€»è¾‘çš„è„šæœ¬ã€‚
*   `config/`: å­˜æ”¾é…ç½®æ–‡ä»¶çš„ç›®å½•ã€‚
    *   `config.json`: âš™ï¸ ä¸»é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šå„ç§è·¯å¾„å’Œå…³é”®å‚æ•°ã€‚
    *   `output_template.xlsx`: ðŸ“„ å®šä¹‰æœ€ç»ˆè¾“å‡ºæ–‡ä»¶æ ¼å¼çš„æ¨¡æ¿ã€‚
    *   `field_mapping/`: å­˜æ”¾å­—æ®µæ˜ å°„è§„åˆ™çš„ JSON æ–‡ä»¶ã€‚
        *   ä¾‹å¦‚: `å…¬åŠ¡å‘˜-å‚å…¬-äº‹ä¸š.json` (æ ¹æ®å®žé™…æ–‡ä»¶åä¿®æ”¹)
*   `input/`: (å»ºè®®) ðŸ“‚ ç”¨äºŽå­˜æ”¾å¾…å¤„ç†çš„æºå·¥èµ„è¡¨å’Œæ‰£æ¬¾æ˜Žç»†è¡¨ã€‚
*   `output/`: (å»ºè®®) ðŸ“¤ ç”¨äºŽå­˜æ”¾å·¥å…·å¤„ç†åŽç”Ÿæˆçš„å·¥èµ„å‘æ”¾è¡¨ã€‚
*   `streamlit_app.log`: ðŸ“ å·¥å…·è¿è¡Œæ—¶äº§ç”Ÿçš„æ—¥å¿—æ–‡ä»¶ï¼Œç”¨äºŽé—®é¢˜æŽ’æŸ¥ã€‚

### 4. è¾“å…¥æ–‡ä»¶è¯¦è§£ ðŸ“„

**4.1 æ–‡ä»¶æ¸…å• âœ…**

è¿è¡Œå·¥å…·å‰ï¼Œè¯·ç¡®ä¿ä»¥ä¸‹æ–‡ä»¶å·²å‡†å¤‡å°±ç»ªå¹¶æ”¾ç½®åœ¨åˆé€‚çš„è·¯å¾„ï¼ˆå»ºè®®æ”¾åœ¨ `input/` ç›®å½•ï¼Œå¹¶åœ¨ `config.json` ä¸­æ­£ç¡®é…ç½®è·¯å¾„ï¼‰ï¼š

1.  **æºå·¥èµ„è¡¨æ–‡ä»¶**:
    *   ä¸€ä¸ªæˆ–å¤šä¸ª Excel æ–‡ä»¶ (`.xlsx`)ã€‚
    *   æ–‡ä»¶åç¤ºä¾‹: `å‚å…¬å·¥èµ„è¡¨-202409.xlsx`, ` å…¬åŠ¡å‘˜å·¥èµ„è¡¨-202409.xlsx`
2.  **æ‰£æ¬¾æ˜Žç»†è¡¨æ–‡ä»¶**:
    *   ä¸€ä¸ª Excel æ–‡ä»¶ (`.xlsx`)ã€‚
    *   æ–‡ä»¶åç¤ºä¾‹: `å…¬åŠ¡å‘˜-å‚å…¬-äº‹ä¸š-æ‰£æ¬¾é¡¹-202409.xlsx`
3.  **ä¸»é…ç½®æ–‡ä»¶**:
    *   `config/config.json`
4.  **å­—æ®µæ˜ å°„è§„åˆ™æ–‡ä»¶**:
    *   ä½äºŽ `config/field_mapping/` ç›®å½•ä¸‹çš„ä¸€ä¸ªæˆ–å¤šä¸ª JSON æ–‡ä»¶ã€‚
    *   æ–‡ä»¶åç¤ºä¾‹: `å­—æ®µåŒ¹é…-å…¬åŠ¡å‘˜-å‚å…¬-äº‹ä¸š.json`
5.  **è¾“å‡ºæ¨¡æ¿æ–‡ä»¶**:
    *   `config/å…¬åŠ¡å‘˜-å‚å…¬-äº‹ä¸š-å¤§å¹³å°è¡¨-æ¨¡æ¿xlsx`

**4.2 æ–‡ä»¶æ ¼å¼æ ‡å‡† ðŸ“**

*   **æºå·¥èµ„è¡¨ (`.xlsx`)**
    *   **æ ¼å¼**: Microsoft Excel (`.xlsx`)ã€‚
    *   **è¡¨å¤´**: **â— é‡è¦ï¼š** è¡¨å¤´è¡Œï¼ˆåŒ…å«å­—æ®µåï¼Œå¦‚"åºå·"ã€"å§“å"ã€"äººå‘˜èº«ä»½"ç­‰ï¼‰**å¿…é¡»**ä½äºŽæ–‡ä»¶çš„**ç¬¬ä¸‰è¡Œ**ï¼ˆå³ Excel ä¸­æ˜¾ç¤ºçš„è¡Œå·ä¸º 3ï¼‰ã€‚ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œå¯ç”¨äºŽå­˜æ”¾æ ‡é¢˜ã€åˆ¶è¡¨å•ä½ã€æ—¥æœŸç­‰ä¿¡æ¯ï¼Œè¿™äº›è¡Œå°†è¢«å¿½ç•¥ã€‚
    *   **æ•°æ®èµ·å§‹**: å®žé™…çš„æ•°æ®è®°å½•åº”ç´§è·Ÿåœ¨ç¬¬ä¸‰è¡Œè¡¨å¤´ä¹‹åŽï¼Œä»Žç¬¬å››è¡Œå¼€å§‹ã€‚
    *   **å¿…éœ€åˆ—**:
        *   `äººå‘˜èº«ä»½` åˆ—ï¼ˆæˆ– `config.json` ä¸­æŒ‡å®šçš„ `source_identity_column`ï¼‰ï¼šå¿…é¡»å­˜åœ¨äºŽç¬¬ä¸‰è¡Œçš„è¡¨å¤´ä¸­ï¼Œç”¨äºŽåŒ¹é… `field_mapping` è§„åˆ™ã€‚
        *   `å§“å` æˆ– `äººå‘˜å§“å` åˆ—ï¼šå¿…é¡»å­˜åœ¨äºŽç¬¬ä¸‰è¡Œçš„è¡¨å¤´ä¸­ï¼Œç”¨äºŽä¸Žæ‰£æ¬¾è¡¨åˆå¹¶ã€‚
        *   æ‰€æœ‰åœ¨ `field_mapping` è§„åˆ™ä¸­è¢«å¼•ç”¨çš„ `source_field` æˆ– `source_fields` éƒ½å¿…é¡»å­˜åœ¨äºŽç¬¬ä¸‰è¡Œçš„è¡¨å¤´ä¸­ï¼Œä¸”åˆ—åå®Œå…¨åŒ¹é…ã€‚
    *   **æ•°æ®ç±»åž‹**: å‚ä¸Žè®¡ç®—çš„åˆ—ï¼ˆå¦‚ `èŒåŠ¡å·¥èµ„`, `çº§åˆ«å·¥èµ„`, `ä¸€æ¬¡æ€§è¡¥æ‰£å‘` ç­‰ï¼‰åº”å°½é‡ä¸ºæ•°å€¼ç±»åž‹ ðŸ”¢ã€‚
    *   **ç‰¹æ®Šè¡Œ**: å·¥å…·ä¼šè‡ªåŠ¨è¿‡æ»¤æŽ‰ `äººå‘˜èº«ä»½` åˆ—ï¼ˆæˆ–æŒ‡å®šåˆ—ï¼‰ä¸­åŒ…å« "åˆè®¡", "æ±‡æ€»", "æ€»è®¡", "å¤‡æ³¨", "è¯´æ˜Ž" ç­‰å…³é”®å­—çš„æ•°æ®è¡Œï¼ˆä»Žç¬¬å››è¡Œå¼€å§‹çš„æ•°æ®è¡Œï¼‰ã€‚

*   **æ‰£æ¬¾æ˜Žç»†è¡¨ (`.xlsx`)**
    *   **æ ¼å¼**: Microsoft Excel (`.xlsx`)ã€‚
    *   **è¡¨å¤´**: **â— é‡è¦ï¼š** è¡¨å¤´è¡Œï¼ˆåŒ…å«å­—æ®µåï¼Œå¦‚"äººå‘˜å§“å"ã€"ä¸ªäººç¼´å…»è€ä¿é™©è´¹"ç­‰ï¼‰**å¿…é¡»**ä½äºŽæ–‡ä»¶çš„**ç¬¬ä¸‰è¡Œ**ï¼ˆå³ Excel ä¸­æ˜¾ç¤ºçš„è¡Œå·ä¸º 3ï¼‰ã€‚
    *   **æ•°æ®èµ·å§‹**: å®žé™…çš„æ‰£æ¬¾æ•°æ®åº”ç´§è·Ÿåœ¨ç¬¬ä¸‰è¡Œè¡¨å¤´ä¹‹åŽï¼Œä»Žç¬¬å››è¡Œå¼€å§‹ã€‚
    *   **å¿…éœ€åˆ—**:
        *   `å§“å` æˆ– `äººå‘˜å§“å` åˆ—ï¼šå¿…é¡»å­˜åœ¨äºŽç¬¬ä¸‰è¡Œçš„è¡¨å¤´ä¸­ï¼Œç”¨äºŽä¸Žæºå·¥èµ„è¡¨åˆå¹¶ã€‚
        *   æ‰€æœ‰éœ€è¦åœ¨æœ€ç»ˆæŠ¥è¡¨ä¸­å±•ç¤ºæˆ–å‚ä¸Žè®¡ç®—çš„æ‰£æ¬¾å­—æ®µåˆ—ï¼ˆå¦‚ `ä¸ªäººç¼´å…»è€ä¿é™©è´¹`, `ä¸ªäººæ‰€å¾—ç¨Ž`, `å…¶ä»–è¡¥æ‰£` ç­‰ï¼‰ï¼šå¿…é¡»å­˜åœ¨äºŽç¬¬ä¸‰è¡Œçš„è¡¨å¤´ä¸­ã€‚
    *   **æ•°æ®ç±»åž‹**: æ‰€æœ‰æ‰£æ¬¾é‡‘é¢åˆ—å¿…é¡»æ˜¯**æ•°å€¼ç±»åž‹** ðŸ”¢ã€‚
    *   **å”¯ä¸€æ€§**: æ¯ä¸ª `å§“å`/`äººå‘˜å§“å` åœ¨æ‰£æ¬¾æ•°æ®åŒºåŸŸï¼ˆä»Žç¬¬å››è¡Œå¼€å§‹ï¼‰ä¸­ç†è®ºä¸Šåº”è¯¥æ˜¯å”¯ä¸€çš„ã€‚

*   **ä¸»é…ç½®æ–‡ä»¶ (`config.json`)** âš™ï¸
    *   **æ ¼å¼**: JSONã€‚
    *   **å…³é”®é…ç½®é¡¹**:
        *   `deduction_table_path`: æŒ‡å‘æ‰£æ¬¾æ˜Žç»†è¡¨æ–‡ä»¶çš„**ç›¸å¯¹æˆ–ç»å¯¹è·¯å¾„**ã€‚
        *   `field_mapping_dir`: æŒ‡å‘å­˜æ”¾å­—æ®µæ˜ å°„è§„åˆ™ JSON æ–‡ä»¶çš„**ç›®å½•è·¯å¾„**ã€‚
        *   `source_files_dir`: æŒ‡å‘å­˜æ”¾æºå·¥èµ„è¡¨æ–‡ä»¶çš„**ç›®å½•è·¯å¾„**ã€‚
        *   `output_dir`: æŒ‡å®šå¤„ç†ç»“æžœæ–‡ä»¶è¾“å‡ºçš„**ç›®å½•è·¯å¾„**ã€‚
        *   `output_template_path`: æŒ‡å‘è¾“å‡ºæ¨¡æ¿ Excel æ–‡ä»¶çš„**è·¯å¾„**ã€‚
        *   `source_identity_column`: æŒ‡å®šæºå·¥èµ„è¡¨ä¸­ç”¨äºŽè¯†åˆ«äººå‘˜èº«ä»½å¹¶åŒ¹é…æ˜ å°„è§„åˆ™çš„åˆ—åï¼ˆé€šå¸¸æ˜¯ `äººå‘˜èº«ä»½`ï¼‰ã€‚
        *   `rule_identity_key`: æŒ‡å®šå­—æ®µæ˜ å°„ JSON æ–‡ä»¶ä¸­ä»£è¡¨äººå‘˜èº«ä»½çš„é‚£ä¸ªé”®åï¼ˆé€šå¸¸ä¹Ÿæ˜¯ `äººå‘˜èº«ä»½`ï¼‰ã€‚

*   **å­—æ®µæ˜ å°„è§„åˆ™æ–‡ä»¶ (`config/field_mapping/*.json`)** ðŸ“
    *   **æ ¼å¼**: JSON æ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åä¼šæ˜¾ç¤ºåœ¨ UI çš„ä¸‹æ‹‰é€‰æ‹©æ¡†ä¸­ã€‚æ–‡ä»¶å†…å®¹æ˜¯ä¸€ä¸ª JSON åˆ—è¡¨ `[]`ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªä»£è¡¨ç‰¹å®šäººå‘˜èº«ä»½è§„åˆ™çš„å¯¹è±¡ `{}`ã€‚
    *   **è§„åˆ™å¯¹è±¡ç»“æž„**:
        ```json
        {
          "äººå‘˜èº«ä»½": "å‚å…¬äººå‘˜",
          "ç¼–åˆ¶": "å‚å…¬",
          "å²—ä½ç±»åˆ«": "å‚å…¬äººå‘˜",
          "mappings": [
            { "source_field": "æºåˆ—A", "target_field": "ç›®æ ‡åˆ—X" },
            { "source_fields": ["æºåˆ—B", "æºåˆ—C"], "target_field": "ç›®æ ‡åˆ—Y", "calculation": "sum" },
            { "source_fields": ["ç›®æ ‡åˆ—X", "ç›®æ ‡åˆ—Y"], "target_field": "ç›®æ ‡åˆ—Z", "calculation": "ç›®æ ‡åˆ—X + ç›®æ ‡åˆ—Y * 0.1" }
          ]
        }
        ```
    *   **â— é‡è¦**:
        *   `äººå‘˜èº«ä»½` (æˆ– `rule_identity_key` æŒ‡å®šçš„é”®) çš„å€¼å¿…é¡»ä¸Žæºå·¥èµ„è¡¨ `source_identity_column` åˆ—ä¸­çš„å€¼**å®Œå…¨ä¸€è‡´**æ‰èƒ½åŒ¹é…è§„åˆ™ã€‚
        *   `source_field` å’Œ `source_fields` ä¸­çš„åˆ—åå¿…é¡»ä¸Ž**Excel ç¬¬ä¸‰è¡Œè¡¨å¤´**æˆ–**ä¹‹å‰è®¡ç®—ç”Ÿæˆçš„ä¸­é—´ç»“æžœåˆ—**çš„åç§°**å®Œå…¨ä¸€è‡´**ã€‚
        *   `target_field` æ˜¯æœ€ç»ˆè¾“å‡ºæˆ–ä¸­é—´è®¡ç®—ç»“æžœçš„åˆ—åã€‚
        *   åŒ…å« `source_fields` çš„è§„åˆ™æ˜¯å¤æ‚è®¡ç®—è§„åˆ™ã€‚

    *   **ðŸ’¡ æ˜ å°„è§„åˆ™ç±»åž‹ç¤ºä¾‹**: 
        
        1.  **ç®€å•æ˜ å°„ (Simple Mapping)**: ç›´æŽ¥å°†ä¸€ä¸ªæºåˆ—çš„å€¼å¤åˆ¶åˆ°ç›®æ ‡åˆ—ã€‚
            ```json
            { 
              "source_field": "èŒåŠ¡/æŠ€æœ¯ç­‰çº§ å·¥èµ„", 
              "target_field": "èŒåŠ¡å·¥èµ„" 
            }
            ```
            *è¯´æ˜Ž*: å°†æº Excel æ–‡ä»¶ç¬¬ä¸‰è¡Œè¡¨å¤´ä¸­åä¸º "èŒåŠ¡/æŠ€æœ¯ç­‰çº§ å·¥èµ„" çš„åˆ—ï¼Œåœ¨è¾“å‡ºæ—¶é‡å‘½åä¸º "èŒåŠ¡å·¥èµ„"ã€‚

        2.  **æ±‚å’Œè®¡ç®— (Sum Calculation)**: å°†å¤šä¸ªæºåˆ—çš„å€¼æŒ‰è¡Œç›¸åŠ ï¼Œç»“æžœå­˜å…¥ç›®æ ‡åˆ—ã€‚
            ```json
            { 
              "source_fields": ["ä¸ªäººç¼´å…»è€ä¿é™©è´¹", "ä¸ªäººç¼´åŒ»ç–—ä¿é™©è´¹", "ä¸ªäººç¼´èŒä¸šå¹´é‡‘", "ä¸ªäººç¼´å¤±ä¸šä¿é™©è´¹", "ä¸ªäººç¼´ä½æˆ¿å…¬ç§¯é‡‘", "ä¸ªäººæ‰€å¾—ç¨Ž"], 
              "target_field": "æ‰£å‘åˆè®¡", 
              "calculation": "sum" 
            }
            ```
            *è¯´æ˜Ž*: å°† "ä¸ªäººç¼´å…»è€ä¿é™©è´¹"ã€"ä¸ªäººç¼´åŒ»ç–—ä¿é™©è´¹" ç­‰å¤šä¸ªå­—æ®µçš„å€¼æŒ‰è¡ŒåŠ èµ·æ¥ï¼Œç»“æžœæ”¾å…¥åä¸º "æ‰£å‘åˆè®¡" çš„æ–°åˆ—ä¸­ã€‚

        3.  **è¡¨è¾¾å¼è®¡ç®— (Expression Calculation)**: ä½¿ç”¨ Python è¡¨è¾¾å¼ï¼ŒåŸºäºŽä¸€ä¸ªæˆ–å¤šä¸ªæºåˆ—çš„å€¼è®¡ç®—å‡ºç›®æ ‡åˆ—çš„å€¼ã€‚
            ```json
            { 
              "source_fields": ["åº”å‘å·¥èµ„", "æ‰£å‘åˆè®¡", "å…¶ä»–è¡¥æ‰£"], 
              "target_field": "å®žå‘å·¥èµ„", 
              "calculation": "åº”å‘å·¥èµ„ - æ‰£å‘åˆè®¡ - å…¶ä»–è¡¥æ‰£" 
            }
            ```
            *è¯´æ˜Ž*: é€šè¿‡è®¡ç®— "åº”å‘å·¥èµ„" å‡åŽ» "æ‰£å‘åˆè®¡" å†å‡åŽ» "å…¶ä»–è¡¥æ‰£" çš„å€¼ï¼Œå¾—åˆ° "å®žå‘å·¥èµ„" åˆ—ã€‚æ³¨æ„è¿™é‡Œçš„ `source_fields` ("æ‰£å‘åˆè®¡", "å…¶ä»–è¡¥æ‰£") å¯èƒ½æœ¬èº«å°±æ˜¯é€šè¿‡å…¶ä»–è§„åˆ™è®¡ç®—å‡ºæ¥çš„ä¸­é—´ç»“æžœã€‚

*   **è¾“å‡ºæ¨¡æ¿æ–‡ä»¶ (`config/output_template.xlsx`)** ðŸ“„âž¡ï¸ðŸ“Š
    *   **æ ¼å¼**: Microsoft Excel (`.xlsx`)ã€‚
    *   **å†…å®¹**: åªéœ€åŒ…å«**ä¸€è¡Œè¡¨å¤´**ï¼ˆä½äºŽ**ç¬¬ä¸€è¡Œå³å¯**ï¼‰ã€‚è¿™ä¸€è¡Œå®šä¹‰äº†æœ€ç»ˆè¾“å‡ºæ–‡ä»¶ `*_å·²å¤„ç†.xlsx` ä¸­**åº”è¯¥åŒ…å«å“ªäº›åˆ—**ä»¥åŠå®ƒä»¬çš„**æŽ’åˆ—é¡ºåº**ã€‚
    *   **ä½œç”¨**: å·¥å…·ä¼šä¸¥æ ¼æŒ‰ç…§æ­¤æ¨¡æ¿çš„è¡¨å¤´æ¥ç­›é€‰å’ŒæŽ’åºæœ€ç»ˆè¾“å‡ºçš„åˆ—ã€‚ä¸åœ¨æ¨¡æ¿è¡¨å¤´ä¸­çš„åˆ—å°†è¢«ä¸¢å¼ƒã€‚

### 5. æ“ä½œæ­¥éª¤ â–¶ï¸

1.  **å¯åŠ¨åº”ç”¨**: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯æˆ–å‘½ä»¤è¡Œï¼Œè¿è¡Œ `streamlit run app.py` ðŸš€ã€‚
2.  **ä¸Šä¼ æ‰€éœ€æ–‡ä»¶**
    1. **ä¸Šä¼ æºå·¥èµ„è¡¨**: ç‚¹å‡» "æºæ•°æ®å·¥èµ„è¡¨" ä¸Šä¼ æŒ‰é’® ðŸ“¤ï¼Œé€‰æ‹©æ–‡ä»¶ï¼Œå¯ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ã€‚
    2.  **ä¸Šä¼ ç›®æ ‡è¡¨æ¨¡æ¿**: ç‚¹å‡» "å¯¼å‡ºè¡¨å­—æ®µæ¨¡æ¿" ä¸Šä¼ æŒ‰é’®ï¼Œé€‰æ‹©æ–‡ä»¶ã€‚
    3.  **ä¸Šä¼ æ‰£æ¬¾é¡¹è¡¨**: ç‚¹å‡» "æ‰£æ¬¾é¡¹è¡¨" ä¸Šä¼ æŒ‰é’®ï¼Œé€‰æ‹©æ–‡ä»¶ã€‚
    4.  **ä¸Šä¼ å­—æ®µæ˜ å°„æ–‡ä»¶**: ç‚¹å‡» "å­—æ®µæ˜ å°„è§„åˆ™" ä¸Šä¼ æŒ‰é’®ï¼Œé€‰æ‹©æ–‡ä»¶ã€‚
3.  **å¼€å§‹å¤„ç†**: ç‚¹å‡» "å¼€å§‹å¤„ç†" æŒ‰é’® â–¶ï¸ã€‚å·¥å…·å°†æŒ‰é¡ºåºæ‰§è¡Œå¤„ç†æµç¨‹ã€‚
4.  **ç›‘æŽ§è¿›åº¦**: ç•Œé¢ä¼šæ˜¾ç¤ºå¤„ç†æ—¥å¿— â±ï¸ï¼Œæ‚¨å¯ä»¥å®žæ—¶äº†è§£å¤„ç†è¿›åº¦å’Œæ½œåœ¨çš„è­¦å‘Šæˆ–é”™è¯¯ä¿¡æ¯ã€‚è¯¦ç»†æ—¥å¿—ä¹Ÿä¼šå†™å…¥ `streamlit_app.log` æ–‡ä»¶ ðŸ“ã€‚
5.  **ä¸‹è½½ç»“æžœ**: å¤„ç†æˆåŠŸå®ŒæˆåŽ âœ…ï¼Œç•Œé¢ä¼šæ˜¾ç¤º "å¤„ç†æˆåŠŸå®Œæˆï¼" çš„æ¶ˆæ¯ï¼Œå¹¶æä¾›ä¸€ä¸ª "ä¸‹è½½å·²å¤„ç†æ–‡ä»¶" çš„æŒ‰é’® ðŸ“¥ã€‚ç‚¹å‡»å³å¯ä¸‹è½½ç”Ÿæˆçš„ `*_å·²å¤„ç†.xlsx` æ–‡ä»¶ã€‚

### 6. è¾“å‡ºæ–‡ä»¶ ðŸ“Š

*   **æ ¼å¼**: Microsoft Excel (`.xlsx`)ã€‚
*   **å†…å®¹**: åŒ…å«æ‰€æœ‰å¤„ç†è¿‡çš„äººå‘˜æ•°æ®ã€‚
*   **åˆ—ç»“æž„**: å®Œå…¨ç”± `config/output_template.xlsx` æ–‡ä»¶å®šä¹‰ã€‚
*   **å…³é”®è®¡ç®—åˆ—**:
    *   `æ‰£å‘åˆè®¡`: æ ¹æ®è§„åˆ™ä»Žå„é¡¹æ‰£æ¬¾æ˜Žç»†åŠ æ€»ã€‚
    *   `è¡¥å‘å·¥èµ„` (æˆ–ç±»ä¼¼): æ ¹æ®è§„åˆ™ä»Žå„é¡¹è¡¥å‘/è¡¥æ‰£å­—æ®µåŠ æ€»ã€‚
    *   `å®žå‘å·¥èµ„`: æ ¹æ®è§„åˆ™é€šè¿‡ `åº”å‘å·¥èµ„`ã€`æ‰£å‘åˆè®¡` ç­‰è®¡ç®—ã€‚

### 7. æ³¨æ„äº‹é¡¹ä¸Žå¸¸è§é—®é¢˜æŽ’æŸ¥ âš ï¸â“

*   **âš ï¸ å§“ååŒ¹é…**: ç¡®ä¿æºå·¥èµ„è¡¨å’Œæ‰£æ¬¾è¡¨ä¸­çš„å§“ååˆ—ï¼ˆ`å§“å` æˆ– `äººå‘˜å§“å`ï¼‰èƒ½å¤ŸåŒ¹é…ã€‚æ£€æŸ¥ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦ã€‚
*   **âš ï¸ å­—æ®µåå®Œå…¨åŒ¹é…**: é…ç½®æ–‡ä»¶å’Œ JSON è§„åˆ™ä¸­çš„åˆ—åå¿…é¡»ä¸Ž Excel æ–‡ä»¶**ç¬¬ä¸‰è¡Œè¡¨å¤´**çš„åˆ—å**å¤§å°å†™ã€ç©ºæ ¼å®Œå…¨ä¸€è‡´**ã€‚
*   **âš ï¸ äººå‘˜èº«ä»½åŒ¹é…**: æºå·¥èµ„è¡¨ä¸­çš„ `äººå‘˜èº«ä»½` å€¼å¿…é¡»ä¸Ž JSON è§„åˆ™ä¸­çš„èº«ä»½æ ‡è¯†**å®Œå…¨ä¸€è‡´**ã€‚
*   **âš ï¸ æ•°æ®ç±»åž‹**: ç¡®ä¿ Excel ä¸­éœ€è®¡ç®—çš„åˆ—æ˜¯æ•°å€¼ç±»åž‹ ðŸ”¢ã€‚
*   **â“ NaN/ç©ºå€¼ç»“æžœ**: è®¡ç®—ç»“æžœä¸ºç©ºæˆ– NaNï¼Ÿå¸¸è§åŽŸå› ï¼š
    *   åˆå¹¶å¤±è´¥ï¼ˆå§“åä¸åŒ¹é…ï¼‰ã€‚
    *   æºå­—æ®µä¸å­˜åœ¨æˆ–åœ¨å¤„ç†ä¸­ä¸¢å¤±ï¼ˆæ£€æŸ¥æ–‡ä»¶å’Œæ˜ å°„è§„åˆ™ï¼‰ã€‚
    *   æºå­—æ®µå€¼ä¸ºæ–‡æœ¬ã€‚
*   **ðŸ’¡ æ£€æŸ¥æ—¥å¿—**: é‡åˆ°é—®é¢˜ï¼Œè¯·é¦–å…ˆæŸ¥çœ‹ç•Œé¢æ—¥å¿—å’Œ `streamlit_app.log` æ–‡ä»¶ ðŸ“ã€‚
*   **ðŸ’¡ å¤‡ä»½é…ç½®**: ä¿®æ”¹ `.json` æˆ– `config.json` å‰ï¼Œå»ºè®®å¤‡ä»½ã€‚

### 8. é…ç½®è¯´æ˜Ž (è¿›é˜¶) ðŸ’¡

*   **`config.json`** âš™ï¸:
    *   å…³æ³¨è·¯å¾„è®¾ç½®ï¼Œä»¥åŠ `source_identity_column` å’Œ `rule_identity_key` çš„æ­£ç¡®æ€§ã€‚
*   **å­—æ®µæ˜ å°„ (`field_mapping/*.json`)** ðŸ“:
    *   **é™æ€å­—æ®µ**: è§„åˆ™å¯¹è±¡é¡¶å±‚çš„é”®å€¼å¯¹ä¼šè¢«ç›´æŽ¥æ·»åŠ ã€‚
    *   **ç®€å•æ˜ å°„**: `"source_field"` -> `